import{d as x,r as n,c as d,a as u,b as o,w as c,e as p,f as y,v,g as S,h as V,u as I,o as m,i as N}from"./index-l_8RPnVV.js";import{a as T}from"./index-NIGUFBhG.js";const q=x("user",()=>{const r=n(sessionStorage.getItem("token")||"");function t(a){r.value=a,sessionStorage.setItem("token",a)}function s(){r.value="",sessionStorage.removeItem("token")}return{token:r,setToken:t,clearToken:s}}),B={id:"loginPage",class:"bg-yellow"},P={class:"conatiner loginPage vhContainer"},U={class:"formControls",action:"index.html"},E={key:0},L={key:1},M="https://todolist-api.hexschool.io",J={__name:"LoginView",setup(r){const t=n(""),s=n(""),a=n(!1),g=n([]),f=n(""),k=I(),w=d(()=>a.value&&t.value===""),_=d(()=>a.value&&s.value===""),b=q(),h=async()=>{if(a.value=!0,!(!t.value||!s.value))try{const l=await T.post(`${M}/users/sign_in`,{email:t.value,password:s.value});alert("登入成功"),t.value="",s.value="",a.value=!1,f.value=l.data.token,b.setToken(l.data.token),await k.push("/todo")}catch(l){alert("登入失敗"),g.value=JSON.parse(l.request.response)}};return(l,e)=>{const C=V("router-link");return m(),u("div",B,[o("div",P,[e[6]||(e[6]=o("div",{class:"side"},[o("a",{href:"#"},[o("img",{class:"logoImg",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:""})]),o("img",{class:"d-m-n",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/img.png",alt:"workImg"})],-1)),o("div",null,[o("form",U,[e[3]||(e[3]=o("h2",{class:"formControls_txt"},"最實用的線上代辦事項服務",-1)),e[4]||(e[4]=o("label",{class:"formControls_label",for:"email"},"Email",-1)),c(o("input",{class:"formControls_input",type:"text",id:"email",name:"email",placeholder:"請輸入 email",required:"","onUpdate:modelValue":e[0]||(e[0]=i=>t.value=i)},null,512),[[v,t.value]]),w.value?(m(),u("span",E,"此欄位不可留空")):p("",!0),e[5]||(e[5]=o("label",{class:"formControls_label",for:"pwd"},"密碼",-1)),c(o("input",{class:"formControls_input",type:"password",name:"pwd",id:"pwd",placeholder:"請輸入密碼",required:"","onUpdate:modelValue":e[1]||(e[1]=i=>s.value=i)},null,512),[[v,s.value]]),_.value?(m(),u("span",L,"此欄位不可留空")):p("",!0),o("input",{class:"formControls_btnSubmit",type:"button",onClick:h,value:"登入"}),y(C,{to:"/signup",class:"formControls_btnLink"},{default:S(()=>[...e[2]||(e[2]=[N("註冊帳號",-1)])]),_:1})])])])])}}};export{J as default};
